<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AgriVision тАФ Crop & Disease Detector</title>
<script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0"></script>
<script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;500;700;800&display=swap" rel="stylesheet">
<style>
:root { --bg1:#f4fff7; --bg2:#e6f6e7; --accent:#2f7e12; --muted:#6b7a66; --card:#fff; }
body{ margin:0; font-family:Inter,sans-serif; background:linear-gradient(180deg,var(--bg1),var(--bg2)); display:flex; justify-content:center; align-items:center; min-height:100vh; padding:16px;}
.app{ background:var(--card); border-radius:16px; box-shadow:0 12px 28px rgba(0,0,0,0.1); padding:24px; max-width:900px; width:100%; display:grid; grid-template-columns:1fr 300px; gap:20px;}
@media(max-width:850px){.app{grid-template-columns:1fr;} }
h1{margin:0;color:var(--accent);}
.controls button, .controls select{margin:6px;padding:10px 14px;font-weight:600;border-radius:10px;border:none;cursor:pointer;}
.btn-primary{background:var(--accent);color:#fff;}
.media{background:var(--card);border-radius:12px;padding:10px;display:flex;justify-content:center;align-items:center;min-height:240px;box-shadow:0 8px 20px rgba(0,0,0,0.05);}
video,img{width:100%;height:auto;border-radius:8px;max-height:400px;object-fit:contain;}
.right{display:flex;flex-direction:column;gap:12px;}
.result-card{background:var(--card);padding:14px;border-radius:12px;box-shadow:0 8px 20px rgba(0,0,0,0.05);}
.prediction{font-size:20px;font-weight:800;color:var(--accent);}
.prob{font-size:14px;color:var(--muted);}
.spinner{width:14px;height:14px;border-radius:50%;border:2px solid rgba(0,0,0,.1);border-top-color:var(--accent);animation:spin 1s linear infinite;display:inline-block;}
@keyframes spin { to{transform:rotate(360deg);} }
.hint { font-size:13px;color:var(--muted); margin-top:8px;}
</style>
</head>
<body>
<div class="app">
<div class="left">
<h1 id="title">AgriVision тАФ Crop & Disease Detector</h1>
<div class="controls">
<button id="btn-open">Open Camera</button>
<label class="btn-upload" style="cursor:pointer;">
<span id="uploadText" style="display:inline-block;margin:6px;padding:10px 14px;border-radius:10px;background:#eee;">Upload Image</span>
<input type="file" id="file" accept="image/*" style="display:none;">
</label>
<button id="btn-detect" class="btn-primary" disabled>Detect</button>
<select id="langSelect">
<option value="en">English</option>
<option value="hi">рд╣рд┐рдиреНрджреА</option>
<option value="bn">ржмрж╛ржВрж▓рж╛</option>
<option value="ta">родрооро┐ро┤рпН</option>
<option value="te">р░др▒Жр░▓р▒Бр░Чр▒Б</option>
<option value="mr">рдорд░рд╛рдареА</option>
<option value="gu">ркЧрлБркЬрк░рк╛ркдрлА</option>
<option value="kn">р▓Хр▓ир│Нр▓ир▓б</option>
<option value="ml">р┤ор┤▓р┤пр┤╛р┤│р┤В</option>
</select>
</div>
<div class="media" id="media-area">
<div id="placeholder" style="text-align:center;color:var(--muted);padding:8px;">
Preview<br>Open camera or upload an image
</div>
<video id="webcam" autoplay playsinline style="display:none;"></video>
<img id="imgPreview" style="display:none;" alt="preview image">
</div>
<div style="margin-top:12px;" id="model-status">
<span class="spinner" style="margin-right:8px;"></span>
Loading Teachable Machine model...
</div>
<div class="hint" id="hintText">Use camera or upload image to detect crop health.</div>
</div>
<div class="right">
<div class="result-card">
<div id="predictionLabel">Prediction</div>
<div class="prediction" id="predictionText">тАФ</div>
<div class="prob" id="predictionProb">тАФ</div>
<div style="margin-top:10px;">
<button id="btn-more">More Info</button>
<button id="btn-buy" class="btn-primary">Buy Products</button>
</div>
<div style="margin-top:10px;font-size:13px;color:var(--muted)" id="statusText">Status: Waiting for model</div>
</div>
</div>
</div>
<canvas id="hiddenCanvas" style="display:none;"></canvas>

<script>
// ЁЯМР All Language Translations (9 Indian Languages)
const texts = {
en:{title:"AgriVision тАФ Crop & Disease Detector",upload:"Upload Image",open:"Open Camera",detect:"Detect",placeholder:"Preview\nOpen camera or upload an image",hint:"Use camera or upload image to detect crop health.",prediction:"Prediction",more:"More Info",buy:"Buy Products",statusWait:"Status: Waiting for model",statusCamera:"Status: Camera open",statusImage:"Status: Image loaded",statusDetect:"Status: Detection complete тЬЕ"},
hi:{title:"рдПрдЧреНрд░реАрд╡рд┐рдЬрди тАФ рдлрд╕рд▓ рдПрд╡рдВ рд░реЛрдЧ рдкрд╣рдЪрд╛рди",upload:"рдЫрд╡рд┐ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ",open:"рдХреИрдорд░рд╛ рдЦреЛрд▓реЗрдВ",detect:"рдкрддрд╛ рдХрд░реЗрдВ",placeholder:"рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди\nрдХреИрдорд░рд╛ рдЦреЛрд▓реЗрдВ рдпрд╛ рдЫрд╡рд┐ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВ",hint:"рдлрд╕рд▓ рдХреА рд╕реНрдерд┐рддрд┐ рдХрд╛ рдкрддрд╛ рд▓рдЧрд╛рдиреЗ рдХреЗ рд▓рд┐рдП рдХреИрдорд░рд╛ рдпрд╛ рдЫрд╡рд┐ рдЕрдкрд▓реЛрдб рдХрд░реЗрдВред",prediction:"рдкреВрд░реНрд╡рд╛рдиреБрдорд╛рди",more:"рдЕрдзрд┐рдХ рдЬрд╛рдирдХрд╛рд░реА",buy:"рдЙрддреНрдкрд╛рдж рдЦрд░реАрджреЗрдВ",statusWait:"рд╕реНрдерд┐рддрд┐: рдореЙрдбрд▓ рдХреА рдкреНрд░рддреАрдХреНрд╖рд╛",statusCamera:"рд╕реНрдерд┐рддрд┐: рдХреИрдорд░рд╛ рдЦреБрд▓рд╛",statusImage:"рд╕реНрдерд┐рддрд┐: рдЫрд╡рд┐ рд▓реЛрдб рдХреА рдЧрдИ",statusDetect:"рд╕реНрдерд┐рддрд┐: рдкрд╣рдЪрд╛рди рдкреВрд░реА тЬЕ"},
bn:{title:"AgriVision тАФ ржлрж╕рж▓ ржУ рж░рзЛржЧ рж╢ржирж╛ржХрзНрждржХрж░ржг",upload:"ржЫржмрж┐ ржЖржкрж▓рзЛржб ржХрж░рзБржи",open:"ржХрзНржпрж╛ржорзЗрж░рж╛ ржЦрзБрж▓рзБржи",detect:"рж╢ржирж╛ржХрзНржд ржХрж░рзБржи",placeholder:"ржкрзНрж░рж┐ржнрж┐ржЙ\nржХрзНржпрж╛ржорзЗрж░рж╛ ржЦрзБрж▓рзБржи ржмрж╛ ржЫржмрж┐ ржЖржкрж▓рзЛржб ржХрж░рзБржи",hint:"ржлрж╕рж▓рзЗрж░ ржЕржмрж╕рзНржерж╛ ржЬрж╛ржирждрзЗ ржХрзНржпрж╛ржорзЗрж░рж╛ ржмрж╛ ржЫржмрж┐ ржЖржкрж▓рзЛржб ржХрж░рзБржиред",prediction:"ржкрзВрж░рзНржмрж╛ржнрж╛рж╕",more:"ржЖрж░ржУ рждржерзНржп",buy:"ржкржгрзНржп ржХрж┐ржирзБржи",statusWait:"ржЕржмрж╕рзНржерж╛: ржоржбрзЗрж▓ ржЕржкрзЗржХрзНрж╖ржорж╛ржг",statusCamera:"ржЕржмрж╕рзНржерж╛: ржХрзНржпрж╛ржорзЗрж░рж╛ ржЦрзЛрж▓рж╛",statusImage:"ржЕржмрж╕рзНржерж╛: ржЫржмрж┐ рж▓рзЛржб рж╣ржпрж╝рзЗржЫрзЗ",statusDetect:"ржЕржмрж╕рзНржерж╛: рж╢ржирж╛ржХрзНржд рж╕ржорзНржкржирзНржи тЬЕ"},
ta:{title:"AgriVision тАФ рокропро┐ро░рпН рооро▒рпНро▒рпБроорпН роирпЛропрпН роХрогрпНроЯро▒ро┐родро▓рпН",upload:"рокроЯродрпНродрпИ рокродро┐ро╡рпЗро▒рпНро▒рпБроХ",open:"роХрпЗрооро░ро╛ родро┐ро▒",detect:"роХрогрпНроЯро▒ро┐роп",placeholder:"роорпБройрпНродрпЛро▒рпНро▒роорпН\nроХрпЗрооро░ро╛ родро┐ро▒роХрпНроХро╡рпБроорпН роЕро▓рпНро▓родрпБ рокроЯроорпН рокродро┐ро╡рпЗро▒рпНро▒ро╡рпБроорпН",hint:"рокропро┐ро░рпН роиро┐ро▓рпИропрпИ роЕро▒ро┐роп роХрпЗрооро░ро╛ роЕро▓рпНро▓родрпБ рокроЯродрпНродрпИрокрпН рокропройрпНрокроЯрпБродрпНродро╡рпБроорпН.",prediction:"роорпБройрпНройро▒ро┐ро╡ро┐рокрпНрокрпБ",more:"роорпЗро▓рпБроорпН родроХро╡ро▓рпН",buy:"родропро╛ро░ро┐рокрпНрокрпБроХро│рпН ро╡ро╛роЩрпНроХ",statusWait:"роиро┐ро▓рпИ: рооро╛родро┐ро░ро┐ роХро╛родрпНродро┐ро░рпБроХрпНроХро┐ро▒родрпБ",statusCamera:"роиро┐ро▓рпИ: роХрпЗрооро░ро╛ родро┐ро▒роирпНродродрпБ",statusImage:"роиро┐ро▓рпИ: рокроЯроорпН роПро▒рпНро▒рокрпНрокроЯрпНроЯродрпБ",statusDetect:"роиро┐ро▓рпИ: роХрогрпНроЯро▒ро┐родро▓рпН роорпБроЯро┐роирпНродродрпБ тЬЕ"},
te:{title:"AgriVision тАФ р░кр░Вр░Я р░ор░░р░┐р░пр▒Б р░╡р▒Нр░пр░╛р░зр░┐ р░Чр▒Бр░░р▒Нр░др░┐р░Вр░кр▒Б",upload:"р░Ър░┐р░др▒Нр░░р░╛р░ир▒Нр░ир░┐ р░Ер░кр▒Нр░▓р▒Лр░бр▒Н р░Ър▒Зр░пр░Вр░бр░┐",open:"р░Хр▒Жр░ор▒Жр░░р░╛ р░Ур░кр▒Жр░ир▒Н р░Ър▒Зр░пр░Вр░бр░┐",detect:"р░Чр▒Бр░░р▒Нр░др░┐р░Вр░Ър▒Б",placeholder:"р░кр▒Нр░░р░┐р░╡р▒Нр░пр▒В\nр░Хр▒Жр░ор▒Жр░░р░╛ р░Ур░кр▒Жр░ир▒Н р░Ър▒Зр░пр░Вр░бр░┐ р░▓р▒Зр░жр░╛ р░Ър░┐р░др▒Нр░░р░В р░Ер░кр▒Нр░▓р▒Лр░бр▒Н р░Ър▒Зр░пр░Вр░бр░┐",hint:"р░кр░Вр░Я р░Жр░░р▒Лр░Чр▒Нр░пр░╛р░ир▒Нр░ир░┐ р░др▒Жр░▓р▒Бр░╕р▒Бр░Хр▒Лр░╡р░бр░╛р░ир░┐р░Хр░┐ р░Хр▒Жр░ор▒Жр░░р░╛ р░▓р▒Зр░жр░╛ р░Ър░┐р░др▒Нр░░р░В р░Йр░кр░пр▒Лр░Чр░┐р░Вр░Ър░Вр░бр░┐.",prediction:"р░Ер░Вр░Ър░ир░╛",more:"р░ор░░р░┐р░ир▒Нр░ир░┐ р░╕р░ор░╛р░Ър░╛р░░р░В",buy:"р░Йр░др▒Нр░кр░др▒Нр░др▒Бр░▓р▒Б р░Хр▒Кр░ир░Вр░бр░┐",statusWait:"р░╕р▒Нр░ер░┐р░др░┐: р░ор▒Лр░бр░▓р▒Н р░Хр▒Лр░╕р░В р░╡р▒Зр░Ър░┐ р░Йр░Вр░жр░┐",statusCamera:"р░╕р▒Нр░ер░┐р░др░┐: р░Хр▒Жр░ор▒Жр░░р░╛ р░Ур░кр▒Жр░ир▒Н",statusImage:"р░╕р▒Нр░ер░┐р░др░┐: р░Ър░┐р░др▒Нр░░р░В р░▓р▒Лр░бр▒Н р░Ер░пр▒Нр░пр░┐р░Вр░жр░┐",statusDetect:"р░╕р▒Нр░ер░┐р░др░┐: р░Чр▒Бр░░р▒Нр░др░┐р░Вр░кр▒Б р░кр▒Вр░░р▒Нр░др░пр░┐р░Вр░жр░┐ тЬЕ"},
mr:{title:"AgriVision тАФ рдкреАрдХ рдЖрдгрд┐ рд░реЛрдЧ рд╢реЛрдзрдХ",upload:"рдкреНрд░рддрд┐рдорд╛ рдЕрдкрд▓реЛрдб рдХрд░рд╛",open:"рдХреЕрдореЗрд░рд╛ рдЙрдШрдбрд╛",detect:"рдУрд│рдЦрд╛",placeholder:"рдкреВрд░реНрд╡рд╛рд╡рд▓реЛрдХрди\nрдХреЕрдореЗрд░рд╛ рдЙрдШрдбрд╛ рдХрд┐рдВрд╡рд╛ рдкреНрд░рддрд┐рдорд╛ рдЕрдкрд▓реЛрдб рдХрд░рд╛",hint:"рдкреАрдХрд╛рдЪреА рд╕реНрдерд┐рддреА рдУрд│рдЦрдгреНрдпрд╛рд╕рд╛рдареА рдХреЕрдореЗрд░рд╛ рдХрд┐рдВрд╡рд╛ рдкреНрд░рддрд┐рдорд╛ рд╡рд╛рдкрд░рд╛.",prediction:"рднрд╡рд┐рд╖реНрдпрд╡рд╛рдгреА",more:"рдЕрдзрд┐рдХ рдорд╛рд╣рд┐рддреА",buy:"рдЙрддреНрдкрд╛рджрдиреЗ рдЦрд░реЗрджреА рдХрд░рд╛",statusWait:"рд╕реНрдерд┐рддреА: рдореЙрдбреЗрд▓рдЪреА рдкреНрд░рддреАрдХреНрд╖рд╛",statusCamera:"рд╕реНрдерд┐рддреА: рдХреЕрдореЗрд░рд╛ рдЙрдШрдбрд▓реЗрд▓рд╛ рдЖрд╣реЗ",statusImage:"рд╕реНрдерд┐рддреА: рдкреНрд░рддрд┐рдорд╛ рд▓реЛрдб рдЭрд╛рд▓реА",statusDetect:"рд╕реНрдерд┐рддреА: рдУрд│рдЦ рдкреВрд░реНрдг тЬЕ"},
gu:{title:"AgriVision тАФ рккрк╛ркХ ркЕркирлЗ рк░рлЛркЧ ркбрк┐ркЯрлЗркХрлНркЯрк░",upload:"ркЫркмрлА ркЕрккрк▓рлЛркб ркХрк░рлЛ",open:"ркХрлЗркорлЗрк░рк╛ ркЦрлЛрк▓рлЛ",detect:"ркУрк│ркЦрлЛ",placeholder:"рккрлВрк░рлНрк╡ркжрк░рлНрк╢рки\nркХрлЗркорлЗрк░рк╛ ркЦрлЛрк▓рлЛ ркЕркерк╡рк╛ ркЫркмрлА ркЕрккрк▓рлЛркб ркХрк░рлЛ",hint:"рккрк╛ркХркирлА рк╕рлНркерк┐ркдрк┐ ркЬрк╛ркгрк╡рк╛ ркорк╛ркЯрлЗ ркХрлЗркорлЗрк░рк╛ ркЕркерк╡рк╛ ркЫркмрлАркирлЛ ркЙрккркпрлЛркЧ ркХрк░рлЛ.",prediction:"ркЕркирлБркорк╛рки",more:"рк╡ркзрлБ ркорк╛рк╣рк┐ркдрлА",buy:"ркЙркдрлНрккрк╛ркжркирлЛ ркЦрк░рлАркжрлЛ",statusWait:"рк╕рлНркерк┐ркдрк┐: ркорлЛркбрлЗрк▓ркирлА рк░рк╛рк╣ ркЬрлЛрк╡рлА",statusCamera:"рк╕рлНркерк┐ркдрк┐: ркХрлЗркорлЗрк░рк╛ ркЦрлБрк▓рлНрк▓рлЛ",statusImage:"рк╕рлНркерк┐ркдрк┐: ркЫркмрлА рк▓рлЛркб ркеркИ",statusDetect:"рк╕рлНркерк┐ркдрк┐: ркУрк│ркЦ рккрлВрк░рлНркг тЬЕ"},
kn:{title:"AgriVision тАФ р▓мр│Жр▓│р│Ж р▓ор▓др│Нр▓др│Б р▓░р│Лр▓Ч р▓кр▓др│Нр▓др│Ж",upload:"р▓Ър▓┐р▓др│Нр▓░р▓╡р▓ир│Нр▓ир│Б р▓Ер▓кр│НтАМр▓▓р│Лр▓бр│Н р▓ор▓╛р▓бр▓┐",open:"р▓Хр│Нр▓пр▓╛р▓ор│Жр▓░р▓╛р▓╡р▓ир│Нр▓ир│Б р▓др│Жр▓░р│Жр▓пр▓┐р▓░р▓┐",detect:"р▓╣р│Жр▓Ър│Нр▓Ър│Бр▓ор▓╛р▓бр▓┐",placeholder:"р▓кр│Вр▓░р│Нр▓╡р▓жр│Гр▓╢р│Нр▓п\nр▓Хр│Нр▓пр▓╛р▓ор│Жр▓░р▓╛р▓╡р▓ир│Нр▓ир│Б р▓др│Жр▓░р│Жр▓пр▓┐р▓░р▓┐ р▓Ер▓ер▓╡р▓╛ р▓Ър▓┐р▓др│Нр▓░р▓╡р▓ир│Нр▓ир│Б р▓Ер▓кр│НтАМр▓▓р│Лр▓бр│Н р▓ор▓╛р▓бр▓┐",hint:"р▓мр│Жр▓│р│Жр▓п р▓Жр▓░р│Лр▓Чр│Нр▓пр▓╡р▓ир│Нр▓ир│Б р▓др▓┐р▓│р▓┐р▓пр▓▓р│Б р▓Хр│Нр▓пр▓╛р▓ор│Жр▓░р▓╛ р▓Ер▓ер▓╡р▓╛ р▓Ър▓┐р▓др│Нр▓░р▓╡р▓ир│Нр▓ир│Б р▓мр▓│р▓╕р▓┐.",prediction:"р▓Ер▓ир│Бр▓╡р▓╛р▓ж",more:"р▓╣р│Жр▓Ър│Нр▓Ър▓┐р▓и р▓ор▓╛р▓╣р▓┐р▓др▓┐",buy:"р▓Йр▓др│Нр▓кр▓ир│Нр▓ир▓Чр▓│р▓ир│Нр▓ир│Б р▓Цр▓░р│Ар▓жр▓┐р▓╕р▓┐",statusWait:"р▓╕р│Нр▓ер▓┐р▓др▓┐: р▓ор▓╛р▓жр▓░р▓┐р▓пр▓ир│Нр▓ир│Б р▓Хр▓╛р▓пр│Бр▓др│Нр▓др▓┐р▓жр│Ж",statusCamera:"р▓╕р│Нр▓ер▓┐р▓др▓┐: р▓Хр│Нр▓пр▓╛р▓ор│Жр▓░р▓╛ р▓др│Жр▓░р│Жр▓пр▓▓р▓╛р▓Чр▓┐р▓жр│Ж",statusImage:"р▓╕р│Нр▓ер▓┐р▓др▓┐: р▓Ър▓┐р▓др│Нр▓░ р▓▓р│Лр▓бр│Н р▓Жр▓Чр▓┐р▓жр│Ж",statusDetect:"р▓╕р│Нр▓ер▓┐р▓др▓┐: р▓кр▓др│Нр▓др│Ж р▓кр│Вр▓░р│Нр▓гр▓Чр│Кр▓Вр▓бр▓┐р▓жр│Ж тЬЕ"},
ml:{title:"AgriVision тАФ р┤╡р┤┐р┤│р┤пр╡Бр┤В р┤░р╡Лр┤Чр┤╡р╡Бр┤В р┤Хр┤гр╡Нр┤Яр╡Жр┤др╡Нр┤др╡╜",upload:"р┤Ър┤┐р┤др╡Нр┤░р┤В р┤Ер┤кр╡НтАМр┤▓р╡Лр┤бр╡Н р┤Ър╡Жр┤пр╡Нр┤пр╡Бр┤Х",open:"р┤Хр╡Нр┤пр┤╛р┤ор┤▒ р┤др╡Бр┤▒р┤Хр╡Нр┤Хр╡Бр┤Х",detect:"р┤Хр┤гр╡Нр┤Яр╡Жр┤др╡Нр┤др╡Бр┤Х",placeholder:"р┤кр╡Нр┤░р┤┐р┤╡р╡Нр┤пр╡В\nр┤Хр╡Нр┤пр┤╛р┤ор┤▒ р┤др╡Бр┤▒р┤Хр╡Нр┤Хр╡Бр┤Х р┤Ер┤▓р╡Нр┤▓р╡Жр┤Щр╡Нр┤Хр┤┐р╡╜ р┤Ър┤┐р┤др╡Нр┤░р┤В р┤Ер┤кр╡НтАМр┤▓р╡Лр┤бр╡Н р┤Ър╡Жр┤пр╡Нр┤пр╡Бр┤Х",hint:"р┤╡р┤┐р┤│р┤пр╡Бр┤Яр╡Ж р┤Жр┤░р╡Лр┤Чр╡Нр┤пр┤В р┤Хр┤гр╡Нр┤Яр╡Жр┤др╡Нр┤др┤╛р╡╗ р┤Хр╡Нр┤пр┤╛р┤ор┤▒ р┤Ер┤▓р╡Нр┤▓р╡Жр┤Щр╡Нр┤Хр┤┐р╡╜ р┤Ър┤┐р┤др╡Нр┤░р┤В р┤Йр┤кр┤пр╡Лр┤Чр┤┐р┤Хр╡Нр┤Хр╡Бр┤Х.",prediction:"р┤кр╡Нр┤░р┤╡р┤Ър┤ир┤В",more:"р┤Хр╡Вр┤Яр╡Бр┤др╡╜ р┤╡р┤┐р┤╡р┤░р┤Щр╡Нр┤Щр╡╛",buy:"р┤Йр╡╜р┤кр╡Нр┤кр┤ир╡Нр┤ир┤Щр╡Нр┤Щр╡╛ р┤╡р┤╛р┤Щр╡Нр┤Щр╡Бр┤Х",statusWait:"р┤ир┤┐р┤▓: р┤ор╡Лр┤бр╡╜ р┤Хр┤╛р┤др╡Нр┤др┤┐р┤░р┤┐р┤Хр╡Нр┤Хр╡Бр┤ир╡Нр┤ир╡Б",statusCamera:"р┤ир┤┐р┤▓: р┤Хр╡Нр┤пр┤╛р┤ор┤▒ р┤др╡Бр┤▒р┤ир╡Нр┤ир┤┐р┤░р┤┐р┤Хр╡Нр┤Хр╡Бр┤ир╡Нр┤ир╡Б",statusImage:"р┤ир┤┐р┤▓: р┤Ър┤┐р┤др╡Нр┤░р┤В р┤▓р╡Лр┤бр╡Н р┤Ър╡Жр┤пр╡Нр┤др╡Б",statusDetect:"р┤ир┤┐р┤▓: р┤Хр┤гр╡Нр┤Яр╡Жр┤др╡Нр┤др╡╜ р┤кр╡Вр╡╝р┤др╡Нр┤др┤┐р┤пр┤╛р┤пр┤┐ тЬЕ"}
};

const classTranslations = {
"Healthy Leaf": { en:"Healthy Leaf", hi:"рд╕реНрд╡рд╕реНрде рдкрддреНрддрд╛", bn:"рж╕рзБрж╕рзНрже ржкрж╛рждрж╛", ta:"роЖро░рпЛроХрпНроХро┐роп роЗро▓рпИ", te:"р░Жр░░р▒Лр░Чр▒Нр░пр░Хр░░р░ор▒Ир░и р░Жр░Хр▒Б", mr:"рдирд┐рд░реЛрдЧреА рдкрд╛рди", gu:"рк╕рлНрк╡рк╕рлНрке рккрк╛рки", kn:"р▓Жр▓░р│Лр▓Чр│Нр▓пр▓Хр▓░ р▓Ор▓▓р│Ж", ml:"р┤Жр┤░р╡Лр┤Чр╡Нр┤пр┤Хр┤░р┤ор┤╛р┤п р┤Зр┤▓" },
"Powdery Mildew": { en:"Powdery Mildew", hi:"рдкрд╛рдЙрдбрд░реА рдорд┐рд▓реНрдбреНрдпреВ", bn:"ржкрж╛ржЙржбрж╛рж░рж┐ ржорж┐рж▓ржбрж┐ржЙ", ta:"рокро╡рпБроЯро░ро┐ рооро┐ро▓рпНроЯро┐ропрпВ", te:"р░кр▒Мр░бр░░р▒А р░ор░┐р░▓р▒Нр░бр▒Нр░пр▒В", mr:"рдкрд╛рд╡рдбрд░реА рдорд┐рд▓реНрдбреНрдпреВ", gu:"рккрк╛рк╡ркбрк░рлА ркорк┐рк▓рлНркбрлНркпрлВ", kn:"р▓кр│Мр▓бр▓░р▓┐ р▓ор▓┐р▓▓р│Нр▓бр│Нр▓пр│В", ml:"р┤кр╡Чр┤бр┤▒р┤┐ р┤ор┤┐р╡╜р┤бр╡Нр┤пр╡В" },
"Bacterial Spot": { en:"Bacterial Spot", hi:"рдмреИрдХреНрдЯреАрд░рд┐рдпрд▓ рд╕реНрдкреЙрдЯ", bn:"ржмрзНржпрж╛ржХржЯрзЗрж░рж┐ржпрж╝рж╛рж▓ ржжрж╛ржЧ", ta:"рокро╛роХрпНроЯрпАро░ро┐ропро╛ родро┤рпБроорпНрокрпБ", te:"р░мр░╛р░Хр▒Нр░Яр▒Ар░░р░┐р░пр░╛ р░ор░Ър▒Нр░Ъ", mr:"рдмреЕрдХреНрдЯреЗрд░рд┐рдпрд▓ рд╕реНрдкреЙрдЯ", gu:"ркмрлЗркХрлНркЯрлЗрк░рк┐ркпрк▓ рк╕рлНрккрлЛркЯ", kn:"р▓мр│Нр▓пр▓╛р▓Хр│Нр▓Яр│Ар▓░р▓┐р▓пр▓▓р│Н р▓Хр▓▓р│Ж", ml:"р┤мр┤╛р┤Хр╡Нр┤Яр╡Ар┤░р┤┐р┤пр╡╜ р┤кр┤╛р┤Яр╡Н" }
};

let currentLang='en';
const langSelect=document.getElementById('langSelect');
function updateTexts(){
  const t=texts[currentLang];
  document.getElementById('title').innerText=t.title;
  document.getElementById('uploadText').innerText=t.upload;
  document.getElementById('btn-open').innerText=t.open;
  document.getElementById('btn-detect').innerText=t.detect;
  document.getElementById('placeholder').innerText=t.placeholder;
  document.getElementById('hintText').innerText=t.hint;
  document.getElementById('predictionLabel').innerText=t.prediction;
  document.getElementById('btn-more').innerText=t.more;
  document.getElementById('btn-buy').innerText=t.buy;
  document.getElementById('statusText').innerText=t.statusWait;
}
langSelect.addEventListener('change',()=>{currentLang=langSelect.value;updateTexts();});
updateTexts();

const MODEL_URL="https://teachablemachine.withgoogle.com/models/Bs-ykiSE3/";
let model,webcamStream=null;
const webcamEl=document.getElementById('webcam');
const imgPreview=document.getElementById('imgPreview');
const btnDetect=document.getElementById('btn-detect');
const predictionText=document.getElementById('predictionText');
const predictionProb=document.getElementById('predictionProb');
const modelStatus=document.getElementById('model-status');
const statusTextEl=document.getElementById('statusText');

async function initModel(){
  try{
    const modelURLFull=MODEL_URL+"model.json";
    const metadataURL=MODEL_URL+"metadata.json";
    model=await tmImage.load(modelURLFull,metadataURL);
    modelStatus.innerText="тЬЕ Model loaded successfully!";
    btnDetect.disabled=false;
    statusTextEl.innerText=texts[currentLang].statusWait;
  }catch(e){
    modelStatus.innerText="тЭМ Failed to load model.";
    statusTextEl.innerText=texts[currentLang].hint;
    console.error(e);
  }
}
initModel();

document.getElementById('btn-open').addEventListener('click',async()=>{
  try{
    const stream=await navigator.mediaDevices.getUserMedia({video:true});
    webcamStream=stream;
    webcamEl.srcObject=stream;
    webcamEl.style.display='block';
    imgPreview.style.display='none';
    document.getElementById('placeholder').style.display='none';
    statusTextEl.innerText=texts[currentLang].statusCamera;
  }catch(e){
    alert('Cannot access camera');
    console.error(e);
  }
});

document.getElementById('file').addEventListener('change',()=>{
  const file=document.getElementById('file').files[0];
  if(!file)return;
  if(webcamStream){webcamStream.getTracks().forEach(t=>t.stop());webcamStream=null;}
  const url=URL.createObjectURL(file);
  imgPreview.src=url;
  imgPreview.style.display='block';
  webcamEl.style.display='none';
  document.getElementById('placeholder').style.display='none';
  imgPreview.onload=()=>URL.revokeObjectURL(url);
  statusTextEl.innerText=texts[currentLang].statusImage;
});

btnDetect.addEventListener('click',async()=>{
  if(!model){alert('Model not loaded yet!');return;}
  let prediction;
  if(imgPreview.style.display==='block'){prediction=await model.predict(imgPreview);}
  else if(webcamEl.style.display==='block'){prediction=await model.predict(webcamEl);}
  else{alert('Open camera or upload an image first!');return;}

  prediction.sort((a,b)=>b.probability-a.probability);
  const best=prediction[0];
  const translated=classTranslations[best.className];
  predictionText.innerText=translated?translated[currentLang]:best.className;
  predictionProb.innerText=(best.probability*100).toFixed(2)+"%";
  statusTextEl.innerText=texts[currentLang].statusDetect;
});

document.getElementById('btn-more').onclick=()=>{
  const p=predictionText.innerText;
  if(!p||p==="тАФ")return alert('No prediction available.');
  window.open('https://acis-naitikanand.glide.page/?d='+encodeURIComponent(p),'_blank');
};
document.getElementById('btn-buy').onclick=()=>{window.open('https://acis-naitikanand.glide.page','_blank');};
window.addEventListener('beforeunload',()=>{if(webcamStream)webcamStream.getTracks().forEach(t=>t.stop());});
</script>
</body>
</html>


